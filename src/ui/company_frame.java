/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package ui;

import custom_jPanels.RoundRectGradientPanel;
import custom_jPanels.SimpleGradientPanel;
import farm.entity.DtCompany;
import farmTech.util.HibernateUtil;
import java.util.Iterator;
import java.util.List;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import org.hibernate.HibernateException;
import org.hibernate.Query;
import org.hibernate.Session;
import org.hibernate.Transaction;

/**
 *
 * @author KENT
 */
public class company_frame extends javax.swing.JInternalFrame {
    private JLabel errorFields;

    /**
     * Creates new form company_frame
     */
    public company_frame() {
        initComponents();
        this.formload();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel29 = new RoundRectGradientPanel();
        jLabel269 = new javax.swing.JLabel();
        jLabel232 = new javax.swing.JLabel();
        jLabel251 = new javax.swing.JLabel();
        jPanel30 = new SimpleGradientPanel();
        jLabel281 = new javax.swing.JLabel();
        jLabel284 = new javax.swing.JLabel();
        jLabel279 = new javax.swing.JLabel();
        txtphone1 = new javax.swing.JTextField();
        cmbCountry1 = new javax.swing.JComboBox();
        txtsite1 = new javax.swing.JTextField();
        jLabel272 = new javax.swing.JLabel();
        jLabel275 = new javax.swing.JLabel();
        txtEmail1 = new javax.swing.JTextField();
        txtfax1 = new javax.swing.JTextField();
        cmbState1 = new javax.swing.JComboBox();
        jLabel273 = new javax.swing.JLabel();
        txtId1 = new javax.swing.JTextField();
        jLabel278 = new javax.swing.JLabel();
        jLabel274 = new javax.swing.JLabel();
        jLabel277 = new javax.swing.JLabel();
        txtcomname1 = new javax.swing.JTextField();
        txtStrid1 = new javax.swing.JTextField();
        txtLegalname1 = new javax.swing.JTextField();
        jLabel252 = new javax.swing.JLabel();
        jLabel270 = new javax.swing.JLabel();
        jLabel282 = new javax.swing.JLabel();
        txtCityid1 = new javax.swing.JComboBox();
        jLabel280 = new javax.swing.JLabel();
        jLabel283 = new javax.swing.JLabel();
        jLabel276 = new javax.swing.JLabel();
        txtZip1 = new javax.swing.JTextField();
        jLabel271 = new javax.swing.JLabel();
        jButton54 = new javax.swing.JButton();
        jButton57 = new javax.swing.JButton();

        setClosable(true);
        setDefaultCloseOperation(javax.swing.WindowConstants.HIDE_ON_CLOSE);
        setIconifiable(true);
        setTitle("Company Details");
        setToolTipText("");
        setFont(new java.awt.Font("Segoe UI", 0, 10)); // NOI18N
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/images/ox-cow.png"))); // NOI18N

        jPanel29.setName("card14"); // NOI18N

        jLabel269.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel269.setForeground(new java.awt.Color(161, 98, 25));
        jLabel269.setText("Enter your company information");

        jLabel232.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel232.setText("This system uses this information on your invoices and receipts to communicate with ");

        jLabel251.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel251.setText("your customers and employees.");

        jPanel30.setBorder(javax.swing.BorderFactory.createEmptyBorder(1, 1, 1, 1));
        jPanel30.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel281.setText("State :");
        jPanel30.add(jLabel281, new org.netbeans.lib.awtextra.AbsoluteConstraints(269, 158, -1, 20));

        jLabel284.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel284.setForeground(new java.awt.Color(255, 51, 51));
        jLabel284.setText("* required fields");
        jPanel30.add(jLabel284, new org.netbeans.lib.awtextra.AbsoluteConstraints(49, 336, 110, -1));

        jLabel279.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel279.setText("Email Address :");
        jPanel30.add(jLabel279, new org.netbeans.lib.awtextra.AbsoluteConstraints(59, 281, -1, -1));

        txtphone1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jPanel30.add(txtphone1, new org.netbeans.lib.awtextra.AbsoluteConstraints(169, 218, 131, -1));

        cmbCountry1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        cmbCountry1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Kenya", "Uganda", "Tanzania", "Rwanda", "Ethiopia", "Sudan", "S.Sudan", "Djibouti", "Eritrea", "Somalia" }));
        jPanel30.add(cmbCountry1, new org.netbeans.lib.awtextra.AbsoluteConstraints(169, 188, 131, -1));

        txtsite1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        txtsite1.setText("www.EMR.COM");
        jPanel30.add(txtsite1, new org.netbeans.lib.awtextra.AbsoluteConstraints(169, 305, 347, -1));

        jLabel272.setFont(new java.awt.Font("Segoe UI", 0, 10)); // NOI18N
        jLabel272.setForeground(new java.awt.Color(161, 98, 25));
        jLabel272.setText("The name you use on invoices and legal forms");
        jPanel30.add(jLabel272, new org.netbeans.lib.awtextra.AbsoluteConstraints(169, 74, -1, -1));

        jLabel275.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel275.setText("City :");
        jPanel30.add(jLabel275, new org.netbeans.lib.awtextra.AbsoluteConstraints(59, 164, -1, -1));

        txtEmail1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        txtEmail1.setText("EMRv1@hotmail.com");
        jPanel30.add(txtEmail1, new org.netbeans.lib.awtextra.AbsoluteConstraints(169, 275, 347, -1));

        txtfax1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jPanel30.add(txtfax1, new org.netbeans.lib.awtextra.AbsoluteConstraints(339, 218, 169, -1));

        cmbState1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        cmbState1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Kenya", "Uganda", "Tanzania", "Rwanda", "Ethiopia", "Sudan", "S.Sudan", "Djibouti", "Eritrea", "Somalia" }));
        jPanel30.add(cmbState1, new org.netbeans.lib.awtextra.AbsoluteConstraints(309, 158, 95, -1));

        jLabel273.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel273.setText("Tax ID :");
        jPanel30.add(jLabel273, new org.netbeans.lib.awtextra.AbsoluteConstraints(59, 104, -1, -1));

        txtId1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jPanel30.add(txtId1, new org.netbeans.lib.awtextra.AbsoluteConstraints(169, 98, 195, -1));

        jLabel278.setFont(new java.awt.Font("Segoe UI", 0, 10)); // NOI18N
        jLabel278.setForeground(new java.awt.Color(161, 98, 25));
        jLabel278.setText("Use the format you would like displayed on your forms e.g (888) 000-20100");
        jPanel30.add(jLabel278, new org.netbeans.lib.awtextra.AbsoluteConstraints(170, 245, 340, -1));

        jLabel274.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel274.setText("Street address :");
        jPanel30.add(jLabel274, new org.netbeans.lib.awtextra.AbsoluteConstraints(59, 134, -1, -1));

        jLabel277.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel277.setText("Phone :");
        jPanel30.add(jLabel277, new org.netbeans.lib.awtextra.AbsoluteConstraints(59, 224, -1, -1));

        txtcomname1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jPanel30.add(txtcomname1, new org.netbeans.lib.awtextra.AbsoluteConstraints(169, 28, 273, -1));

        txtStrid1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jPanel30.add(txtStrid1, new org.netbeans.lib.awtextra.AbsoluteConstraints(169, 128, 345, -1));

        txtLegalname1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jPanel30.add(txtLegalname1, new org.netbeans.lib.awtextra.AbsoluteConstraints(169, 54, 273, -1));

        jLabel252.setForeground(new java.awt.Color(255, 51, 0));
        jLabel252.setText("*");
        jPanel30.add(jLabel252, new org.netbeans.lib.awtextra.AbsoluteConstraints(49, 35, 10, -1));

        jLabel270.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel270.setText("Company Name :");
        jPanel30.add(jLabel270, new org.netbeans.lib.awtextra.AbsoluteConstraints(59, 29, -1, 20));

        jLabel282.setText("Zip :");
        jPanel30.add(jLabel282, new org.netbeans.lib.awtextra.AbsoluteConstraints(410, 159, 30, 20));

        txtCityid1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        txtCityid1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Nakuru", "Eldoret", "Kakamega", "Bungoma", "Nairobi", "Mombasa", "Kisumu" }));
        jPanel30.add(txtCityid1, new org.netbeans.lib.awtextra.AbsoluteConstraints(171, 158, 88, -1));

        jLabel280.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel280.setText("Website :");
        jPanel30.add(jLabel280, new org.netbeans.lib.awtextra.AbsoluteConstraints(59, 311, -1, -1));

        jLabel283.setText("Fax :");
        jPanel30.add(jLabel283, new org.netbeans.lib.awtextra.AbsoluteConstraints(309, 225, -1, -1));

        jLabel276.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel276.setText("Country :");
        jPanel30.add(jLabel276, new org.netbeans.lib.awtextra.AbsoluteConstraints(59, 194, -1, -1));

        txtZip1.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        txtZip1.setText("+184");
        jPanel30.add(txtZip1, new org.netbeans.lib.awtextra.AbsoluteConstraints(439, 158, 64, -1));

        jLabel271.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jLabel271.setText("Legal Name :");
        jPanel30.add(jLabel271, new org.netbeans.lib.awtextra.AbsoluteConstraints(59, 54, -1, 20));

        jButton54.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jButton54.setText("Leave");
        jButton54.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton54ActionPerformed(evt);
            }
        });

        jButton57.setFont(new java.awt.Font("Trebuchet MS", 0, 11)); // NOI18N
        jButton57.setText("Save");
        jButton57.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton57ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel29Layout = new javax.swing.GroupLayout(jPanel29);
        jPanel29.setLayout(jPanel29Layout);
        jPanel29Layout.setHorizontalGroup(
            jPanel29Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel29Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addGroup(jPanel29Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel269, javax.swing.GroupLayout.PREFERRED_SIZE, 396, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel232)
                    .addComponent(jLabel251)
                    .addComponent(jPanel30, javax.swing.GroupLayout.PREFERRED_SIZE, 708, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(24, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel29Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jButton54)
                .addGap(9, 9, 9)
                .addComponent(jButton57)
                .addGap(306, 306, 306))
        );
        jPanel29Layout.setVerticalGroup(
            jPanel29Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel29Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(jLabel269)
                .addGap(6, 6, 6)
                .addComponent(jLabel232)
                .addGap(6, 6, 6)
                .addComponent(jLabel251)
                .addGap(6, 6, 6)
                .addComponent(jPanel30, javax.swing.GroupLayout.PREFERRED_SIZE, 360, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel29Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jButton54)
                    .addComponent(jButton57))
                .addGap(20, 20, 20))
        );

        getContentPane().add(jPanel29, java.awt.BorderLayout.CENTER);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jButton54ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton54ActionPerformed
        // TODO add your handling code here:
        this.setVisible(false);
//        Container jpanel1=this.getParent();
//        String name=this.getParent().getComponent(0).getName();
//        CardLayout cardmanager=(CardLayout)(jpanel1.getLayout());
//        cardmanager.show(jpanel1,name);
    }//GEN-LAST:event_jButton54ActionPerformed

    private void jButton57ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton57ActionPerformed
        // TODO add your handling code here:
        String companyName=txtcomname1.getText();
        String legalname=txtLegalname1.getText();
        String taxid=txtId1.getText();
        String saddress=txtStrid1.getText();
        String city=txtCityid1.getSelectedItem().toString();
        String state=cmbState1.getSelectedItem().toString();
        String zip=txtZip1.getText();
        String country=cmbCountry1.getSelectedItem().toString();
        String phone=txtphone1.getText();
        String fax=txtfax1.getText();
        String email=txtEmail1.getText();
        String website=txtsite1.getText();
        if(!companyName.equals("")){
            addCompany(companyName, legalname, taxid, saddress, city, state, zip, country, phone, fax, email, website);
        }else{
            JLabel errorFields = new JLabel("<HTML><FONT COLOR = blue>Please make sure that required fileds are filled!.</FONT></HTML>");
            JOptionPane.showMessageDialog(null,errorFields,"Laundry Management System",JOptionPane.INFORMATION_MESSAGE);
        }
    }//GEN-LAST:event_jButton57ActionPerformed

    public void addCompany(String companyName, String legalName, String taxId, String saddress, String city, String state, String zip, String country, String phone,  String fax, String email, String website){
      Session session = HibernateUtil.getSessionFactory().openSession();      
      Transaction tx = null;
      try{
            tx = session.beginTransaction();
            Query q = session.createQuery("FROM DtCompany company WHERE company.id=:id OR company.taxId=:tax_id");
            q.setParameter("id", 1);
            q.setParameter("tax_id", taxId);
            List results=q.list();
            Iterator iterator=results.iterator();
//         DtCompany company = (DtCompany)session.get(DtCompany.class,taxId);         
         if(!iterator.hasNext()){
            DtCompany company_save=new DtCompany( phone,  companyName,  legalName,  taxId,  saddress,  city,  state,  zip,  country,  fax,  email,  website); 
            session.save(company_save); 
            errorFields = new JLabel("<HTML><FONT COLOR = BLUE>New Company added successfully</FONT></HTML>");
            JOptionPane.showMessageDialog(null,errorFields,"DMS",JOptionPane.INFORMATION_MESSAGE);
         }else{
             DtCompany company = (DtCompany)results.get(0);
             company.setCity(city);
             company.setCompanyName(companyName);
             company.setCountry(country);
             company.setEmail(email);
             company.setFax(fax);
             company.setLegalName(legalName);
             company.setPhone(phone);
             company.setSaddress(saddress);
             company.setState(state);
             company.setTaxId(taxId);
             company.setWebsite(website);
             company.setZip(zip);
             session.update(company);
             errorFields = new JLabel("<HTML><FONT COLOR = BLUE>Company Record Updated successfully</FONT></HTML>");
             JOptionPane.showMessageDialog(null,errorFields,"DMS",JOptionPane.INFORMATION_MESSAGE);
         }
         tx.commit();
      }catch (HibernateException e) {
         if (tx!=null) tx.rollback();
           e.printStackTrace(); 
      }finally {
         session.flush();
         session.close(); 
      }
   }
    
    private void formload() {
    try {
        Session session = HibernateUtil.getSessionFactory().openSession();
        session.beginTransaction();
        Query q = session.createQuery("from DtCompany");
        List resultList = q.list();
        Iterator iterator=resultList.iterator();
        if(iterator.hasNext()){            
            DtCompany details=(DtCompany)iterator.next();
            setComFields(details);
        }
        session.getTransaction().commit();
    } catch (HibernateException he) {
         errorFields = new JLabel("<HTML><FONT COLOR = BLUE>'"+he.getMessage()+"'</FONT></HTML>");
          JOptionPane.showMessageDialog(null,errorFields,"DMS",JOptionPane.INFORMATION_MESSAGE);
    }
}
    
 private void setComFields(DtCompany details){
  txtcomname1.setText(details.getCompanyName());  
  txtLegalname1.setText(details.getLegalName());
  txtId1.setText(details.getTaxId());
  txtStrid1.setText(details.getSaddress());
  txtCityid1.setSelectedItem(details.getCity());
  cmbState1.setSelectedItem(details.getState());
  txtZip1.setText(details.getZip());
  cmbCountry1.setSelectedItem(details.getCountry());
  txtphone1.setText(details.getPhone());
  txtfax1.setText(details.getFax());
  txtEmail1.setText(details.getEmail());
  txtsite1.setText(details.getWebsite());
//  return 0;
}
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox cmbCountry1;
    private javax.swing.JComboBox cmbState1;
    private javax.swing.JButton jButton54;
    private javax.swing.JButton jButton57;
    private javax.swing.JLabel jLabel232;
    private javax.swing.JLabel jLabel251;
    private javax.swing.JLabel jLabel252;
    private javax.swing.JLabel jLabel269;
    private javax.swing.JLabel jLabel270;
    private javax.swing.JLabel jLabel271;
    private javax.swing.JLabel jLabel272;
    private javax.swing.JLabel jLabel273;
    private javax.swing.JLabel jLabel274;
    private javax.swing.JLabel jLabel275;
    private javax.swing.JLabel jLabel276;
    private javax.swing.JLabel jLabel277;
    private javax.swing.JLabel jLabel278;
    private javax.swing.JLabel jLabel279;
    private javax.swing.JLabel jLabel280;
    private javax.swing.JLabel jLabel281;
    private javax.swing.JLabel jLabel282;
    private javax.swing.JLabel jLabel283;
    private javax.swing.JLabel jLabel284;
    private javax.swing.JPanel jPanel29;
    private javax.swing.JPanel jPanel30;
    private javax.swing.JComboBox txtCityid1;
    private javax.swing.JTextField txtEmail1;
    private javax.swing.JTextField txtId1;
    private javax.swing.JTextField txtLegalname1;
    private javax.swing.JTextField txtStrid1;
    private javax.swing.JTextField txtZip1;
    private javax.swing.JTextField txtcomname1;
    private javax.swing.JTextField txtfax1;
    private javax.swing.JTextField txtphone1;
    private javax.swing.JTextField txtsite1;
    // End of variables declaration//GEN-END:variables
}
